@using ChatApp_MAUI.Shared.Components
@using Microsoft.AspNetCore.Components.Authorization
@using Presentation.Shared

@inherits LayoutComponentBase

<MudThemeProvider />
<MudPopoverProvider />

@* Needed for dialogs *@
<MudDialogProvider />

@* Needed for snackbars *@
<MudSnackbarProvider />

<AuthorizeView>
    <Authorizing>
        <LoaderComponent></LoaderComponent>
    </Authorizing>
    <Authorized>
        <MudLayout>
            <MudAppBar Elevation="1" Dense>
                <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@ToggleDrawer" />
                <MudText Typo="Typo.h6" Class="mr-4" Style="color:white;">Campus Connect</MudText>
                <MudButton StartIcon="@Icons.Material.Filled.Warehouse" Color="Color.Inherit" Variant="Variant.Text">Departments</MudButton>
                <MudSpacer />
                <MudBadge Content="100" Color="Color.Inherit" Overlap="true" Class="mx-6 my-4">
                    <MudIcon Icon="@Icons.Material.Filled.Notifications" Color="Color.Inherit"></MudIcon>
                </MudBadge>
            </MudAppBar>
            <MudDrawer @bind-Open="@_open" Class="mt-n6" ClipMode="DrawerClipMode.Docked" Elevation="1" Variant="@DrawerVariant.Responsive">
                <MudNavMenu>
                    <MudNavLink Match="NavLinkMatch.All">Profile</MudNavLink>
                    <MudNavLink Match="NavLinkMatch.All">Change Password</MudNavLink>
                    <MudNavLink Match="NavLinkMatch.All">Logout</MudNavLink>
                </MudNavMenu>
            </MudDrawer>
            <MudMainContent>
                <MudContainer>
                    @Body
                </MudContainer>
            </MudMainContent>
        </MudLayout>    
    </Authorized>
    <NotAuthorized>
        <PreLoaderComponent>
            <ChildComponent>
                <LoginComponent></LoginComponent>
            </ChildComponent>
        </PreLoaderComponent>
    </NotAuthorized>
</AuthorizeView>
@code {
    private bool _open = false;

    private void ToggleDrawer()
    {
        _open = !_open;
    }
}